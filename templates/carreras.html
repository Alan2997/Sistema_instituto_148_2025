<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Carreras - Sistema de Gestión Académica</title>

  <!-- Fuentes y Bootstrap -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">

  <script>
    function showTab(tabName) {
      const tabs = document.querySelectorAll('.tab-content');
      tabs.forEach(tab => tab.style.display = 'none');

      const activeTab = document.getElementById(tabName);
      if (activeTab) {
        activeTab.style.display = 'block';
      }

      const tabButtons = document.querySelectorAll('.tabs button');
      tabButtons.forEach(button => button.classList.remove('active'));
      document.getElementById(tabName + '-btn').classList.add('active');
    }

    window.onload = function() {
      const table = '{{ table }}';  
      if (table === 'carreras_inactivas') {
        showTab('carreras_inactivas');
      } else {
        showTab('carreras');  // por defecto mostramos carreras
      }
    };
  </script>

  <style>
    html {
      margin-left: 15%;
      margin-top: 10%;
      height: 60%;
      align-items: center;
    }
    html, body {
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    #boton-guardar {
      background-color: #518ec3;
      color: #fff;
    }
  </style>
</head>
<body>
  {% include 'navbar.html' %}
  <div class="container">
    {% include 'nav_carreras.html' %}
  </div>

  <div class="container align-content-center align-items-center">

    <!-- Contenido de la pestaña de Carreras -->
    <div id="carreras" class="tab-content" style="display: none;">
      <h5 class="text-primary mt-5">Listado de Carreras</h5>

      <div class="d-flex justify-content-between align-items-center mb-3">
  
      <!-- Formulario de búsqueda y filtros -->
      <form method="GET" action="{{ url_for('carreras') }}" class="form-inline">
        <input type="hidden" name="table" value="carreras">
        <input type="text" name="nombre" class="form-control mr-2" placeholder="Buscar por nombre" value="{{ nombre_busqueda or '' }}">
        
        <!-- Filtro de estado -->
        <label class="mr-2">Estado:</label>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="activo" value="todos" id="todos" {% if estado_activo == 'todos' %}checked{% endif %}>
            <label class="form-check-label" for="todos">Todos</label>
          </div>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="activo" value="activos" id="activos" {% if estado_activo == 'activos' %}checked{% endif %}>
            <label class="form-check-label" for="activos">Activos</label>
          </div>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="activo" value="inactivos" id="inactivos" {% if estado_activo == 'inactivos' %}checked{% endif %}>
            <label class="form-check-label" for="inactivos">Inactivos</label>
          </div>

          <button type="submit" class="btn btn-primary ml-2">
            <i class="fas fa-search"></i> Buscar
          </button>
        </form>

        <!-- Botón de agregar a la derecha -->
        <a href="{{ url_for('agregar_carrera') }}" class="btn btn-success" data-toggle="modal" data-target="#modalAgregarCarrera">
          <i class="fas fa-plus"></i> Agregar
        </a>
      </div>


      <!-- Tabla de carreras -->
      <table class="table table-striped">
        <thead>
          <tr>
            <th>ID</th>
            <th>Nombre</th>
            <th>Descripción</th>
            <th>Activo</th>
            <th>Editar</th>
          </tr>
        </thead>
        <tbody>
          {% for carrera in carreras %}
          <tr>
            {% for campo in carrera %}
            <td>{{ campo or '' }}</td>
            {% endfor %}
            <td>
              <a href="{{ url_for('editar_carrera', id_carrera=carrera[0]) }}">
                <i class="fas fa-edit fa-lg" id="EditIcon"></i>
              </a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>

      <!-- Paginación de Carreras -->
      {% if total_paginas_carreras %}
      <div class="pagination" id="clase-paginas">
        <ul class="pagination">
          {% for p in range(1, total_paginas_carreras + 1) %}
          <li class="page-item {% if p == page %}active{% endif %}" id="cuadrito">
            <a class="page-link" href="{{ url_for('carreras', page=p, table='carreras', activo=estado_activo, nombre=nombre_busqueda) }}">{{ p }}</a>
          </li>
          {% endfor %}
        </ul>
      </div>
      {% endif %}
    </div>

  </div>

   <!-- Modal -->
    <div class="modal fade" id="modalAgregarCarrera" tabindex="-1" role="dialog" aria-labelledby="modalAgregarCarreraLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">

          <div class="modal-header">
            <h5 class="modal-title text-primary" id="modalAgregarCarreraLabel">Agregar Nueva Carrera</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Cerrar">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>

          <form method="POST" action="{{ url_for('agregar_carrera') }}">
            <div class="modal-body">
              <div class="form-row">
                <div class="col-md-4 form-group">
                  <label for="id_carrera">ID Carrera</label>
                  <input type="number" class="form-control form-control-sm" id="id_carrera" name="id_carrera" required>
                </div>
                <div class="col-md-8 form-group">
                  <label for="nombre">Nombre</label>
                  <input type="text" class="form-control form-control-sm" id="nombre" name="nombre" required>
                </div>
                <div class="col-md-12 form-group">
                  <label for="descripcion">Descripción</label>
                  <textarea class="form-control form-control-sm" id="descripcion" name="descripcion" rows="2"></textarea>
                </div>
                <div class="col-md-4 form-group">
                  <label for="tipo">Tipo</label>
                  <input type="text" class="form-control form-control-sm" id="tipo" name="tipo">
                </div>
                <div class="col-md-4 form-group">
                  <label for="anio">Año</label>
                  <input type="number" class="form-control form-control-sm" id="anio" name="anio">
                </div>
                <div class="col-md-4 form-group">
                  <label for="ley">Ley</label>
                  <input type="text" class="form-control form-control-sm" id="ley" name="ley">
                </div>
                <div class="col-md-6 form-group">
                  <label for="fecha">Fecha</label>
                  <input type="date" class="form-control form-control-sm" id="fecha" name="fecha">
                </div>
              </div>
            </div>

            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
              <button type="submit" class="btn" id="boton-guardar">Guardar</button>
            </div>
          </form>
        </div>
      </div>
    </div>

  <!-- Scripts -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.0.6/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script src="bootstrap.bundle.min.js"></script>
</body>
</html>
